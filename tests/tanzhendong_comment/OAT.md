# OAT.py 脚本说明

## 模块说明
`OAT.py` 脚本提供了一个用于生成正交测试组合的 Python 解决方案。它通过读取预定义的正交表数据文件（默认为`data/ts723_Designs.txt`），解析这些数据并将其实例化为可查询的正交表对象。核心功能包括根据给定的测试参数（因素及其水平）计算出合适的正交表，并根据选定的模式（宽松或严格）生成去重且可能包含或不包含 `None` 值的测试集。这对于在有限的测试资源下，高效地测试多因素组合场景非常有用。

## 类清单
- `OAT`: 表示正交表（Orthogonal Array Table）的类，负责加载、解析、存储正交表数据，并提供查询和生成测试集的方法。

## 模块级函数清单
- `dataSplit`: 一个辅助函数，用于根据正交表数据中不同类型字段的编码规则，将原始字符串数据拆分为整数列表。

## 类与方法详细说明

### 类名: `OAT`
- **功能**：正交表类，用于加载、解析正交表数据，并根据用户提供的参数生成正交测试集。
- **方法**：
  #### 方法: `__init__`
  - **功能**：OAT 对象的构造函数，用于初始化并解析正交表数据文件。
  - **参数**：
    - `OAFile` (`str`): 正交表数据文件的路径。默认值为当前脚本所在目录的 `data/ts723_Designs.txt`。
  - **返回值**：
    - `None`: 无返回值。

  #### 方法: `get`
  - **功能**：根据给定的因素和水平组合 (`mk` 参数) 查询并返回合适的正交表数据。
  - **参数**：
    - `mk` (`list`): 一个列表，包含多个 `(m, k)` 对，其中 `m` 代表因素的水平数，`k` 代表具有该水平数的因素数量。例如 `[(2,3)]` 表示有3个因素，每个因素有2个水平；`[(5,5),(2,1)]` 表示有5个因素每个有5个水平，一个因素有2个水平。
  - **返回值**：
    - `list`: 如果找到匹配的正交表数据，返回一个处理后的数据列表，每个子列表代表一个正交测试行的整数值。
    - `None`: 如果没有找到匹配的正交表数据，则返回 `None`。

  #### 方法: `genSets`
  - **功能**：根据传入的测试参数（因素及其水平）和正交表数据生成正交测试集。
  - **参数**：
    - `params` (`OrderedDict`): 一个有序字典，键为参数名称，值为该参数的所有可能水平（列表形式）。
    - `mode` (`int`): 用例裁剪模式。
      - `0`: 宽松模式，只裁剪重复测试集。
      - `1`: 严格模式，除裁剪重复测试集外，还裁剪含 `None` 测试集（`num` 为允许 `None` 测试集的最大数目）。
    - `num` (`int`): 在严格模式（`mode=1`）下，允许测试集中 `None` 值的最大数量。默认为 `1`。
  - **返回值**：
    - `list`: 包含生成的测试集的列表，每个测试集是一个 `OrderedDict`，键为参数名，值为对应的水平。

## 模块级函数说明

### 函数名: `dataSplit`
- **功能**：辅助函数，根据输入数据中的编码规则，将原始的正交表数据行字符串拆分并转换为整数列表。这涉及到单字符数字和双字符数字的混合处理。
- **参数**：
  - `data` (`dict`): 一个字典，包含正交表数据的元信息 `'mk'` 和原始数据字符串列表 `'data'`。
    - `'mk'`: 描述每个因素的水平数和数量的列表。
    - `'data'`: 正交表的原始数据行字符串列表。
- **返回值**：
  - `list`: 拆分并转换后的整数列表，每个子列表代表正交表中的一行。